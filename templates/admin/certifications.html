{% extends "layouts/admin.html" %}

{% block title %}Certification Management{% endblock %}
{% block header_title %}Certification Management{% endblock %}

{% block content %}
  <section class="card form-card">
    <h2>Add Credly Badge</h2>
    <form method="post" action="{{ url_for('admin.certifications') }}" class="form-grid">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

      <div class="form-field">
        <label for="title">Title</label>
        <input id="title" type="text" name="title" placeholder="Optional label" />
      </div>

      <div class="form-field">
        <label for="credly_url">Credly Public URL</label>
        <input
          id="credly_url"
          type="url"
          name="credly_url"
          placeholder="https://www.credly.com/badges/.../public_url"
          required
        />
      </div>

      <div class="form-field">
        <label for="sort_order">Sort</label>
        <input id="sort_order" type="number" name="sort_order" value="0" />
      </div>

      <div class="form-field">
        <label><input type="checkbox" name="is_published" value="1" checked /> Published</label>
      </div>

      <div class="form-field form-field-full">
        <button type="submit">Create</button>
      </div>
    </form>
  </section>

  <section>
    <h2 class="section-title">Saved Badges</h2>
    <div class="card-grid" aria-label="Saved certification badges">
      {% for badge in badges %}
        <article class="card admin-item">
          <form method="post" action="{{ url_for('admin.certifications_update', badge_id=badge.id) }}" class="form-grid">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

            <div class="form-field">
              <label>Title</label>
              <input type="text" name="title" value="{{ badge.title }}" />
            </div>

            <div class="form-field">
              <label>Credly Public URL</label>
              <input type="url" name="credly_url" value="{{ badge.credly_url }}" required />
            </div>

            <div class="form-field">
              <label>Sort</label>
              <input type="number" name="sort_order" value="{{ badge.sort_order }}" />
            </div>

            <div class="form-field">
              <label><input type="checkbox" name="is_published" value="1" {% if badge.is_published %}checked{% endif %} /> Published</label>
            </div>

            <div class="form-field form-field-full">
              <button type="submit">Save</button>
            </div>
          </form>

          <div class="item-actions">
            <a class="btn-link" href="{{ badge.credly_url }}" target="_blank" rel="noreferrer noopener">Open</a>
            <form method="post" action="{{ url_for('admin.certifications_delete', badge_id=badge.id) }}" onsubmit="return confirm('Remove this badge?');">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
              <button type="submit">Remove</button>
            </form>
          </div>
        </article>
      {% else %}
        <article class="card"><p>No badges yet.</p></article>
      {% endfor %}
    </div>
  </section>
{% endblock %}
