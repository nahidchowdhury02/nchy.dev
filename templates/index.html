<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Library</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
  <header>
    <h1>The Quiet Stacks</h1>
  </header>
 

  <main>
    <section class="hero-shelves">
      <div class="dev-box">
        <div class="dev-box-header">
          <span class="dev-box-title">The Library</span>
          <span class="dev-box-subtitle">Volumes kept, examined, and set aside with care</span>
        </div>
        <div class="dev-box-previews" id="dev-previews"></div>
      </div>
      <div class="link-grid">
        <article>
          <h3>Github & Research</h3>
          <p>Repositories of method, trial, and record; notes kept with citation and restraint.</p>
        </article>
        <article>
          <h3>Public Gallery</h3>
          <p>Studies, fragments, and assembled works preserved from the hand.</p>
          <a href="#">View</a>
        </article>
        <article>
          <h3>Music Room</h3>
          <p>Arrangements for solitude tones gathered from rooms, streets, and late hours.</p>
          <a href="#">Listen</a>
        </article>
        <article>
          <h3>Reading List</h3>
          <p>Texts under present consideration, bearing marks, notes, and quiet dispute.</p>
          <a href="#">Open</a>
        </article>
        <article>
          <h3>Playground</h3>
          <p>Mechanical diversions, visual trials, and unfinished contrivances.</p>
          <a href="#">Try</a>
        </article>
        <article>
          <h3>Notes & Logs</h3>
          <p>what was altered, kept, or abandoned.</p>
          <a href="#">Read</a>
        </article>
        <article>
          <h3>Contact</h3>
          <p>Correspondence regarding joint labor, patronage, or exchange.</p>
          <a href="mailto:keeper@archaicarts.com">Email</a>
        </article>
      </div>
    </section>

  </main>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      fetch("/static/data/books.json")
        .then(response => response.json())
        .then(books => {
          const previews = document.getElementById("dev-previews");
          const validBooks = books.filter(b => b.google_info && b.google_info !== "No result");
          const previewSlice = validBooks.slice(0, 8);

          previewSlice.forEach((book) => {
            const title = book.original_title || "Untitled";
            const cover = book.openlib_cover_url && book.openlib_cover_url !== "No cover available"
              ? book.openlib_cover_url
              : "/static/img/placeholder.png";
            const preview = document.createElement("div");
            preview.className = "preview-card";
            preview.innerHTML = `<img src="${cover}" alt="${title}">`;
            previews.appendChild(preview);
          });

          window.generateDetailPage = function (index) {
            const book = books[index];
            const info = book.google_info || {};
            const html = `
              <!DOCTYPE html>
              <html lang="en">
              <head>
                <meta charset="UTF-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <title>${book.original_title || "Book Detail"}</title>
                <style>
                  body { font-family: Arial; padding: 2rem; line-height: 1.6; }
                  img { max-width: 200px; margin-bottom: 1rem; }
                  .field { margin-bottom: 1rem; }
                </style>
              </head>
              <body>
                <h1>${book.original_title || "Untitled"}</h1>
                <img src="${book.openlib_cover_url !== "No cover available" ? book.openlib_cover_url : "/static/img/placeholder.png"}" alt="cover">
                <div class="field"><strong>Authors:</strong> ${info.authors?.join(", ") || "Not available"}</div>
                <div class="field"><strong>Subtitle:</strong> ${info.subtitle || "Not available"}</div>
                <div class="field"><strong>Publisher:</strong> ${info.publisher || "Not available"}</div>
                <div class="field"><strong>Published Date:</strong> ${info.publishedDate || "Not available"}</div>
                <div class="field"><strong>Category:</strong> ${info.categories?.join(", ") || "Not available"}</div>
                <div class="field"><strong>Rating:</strong> ${info.averageRating || "Not rated"}</div>
                <div class="field"><strong>Ratings Count:</strong> ${info.ratingsCount || 0}</div>
                <div class="field"><strong>Page Count:</strong> ${info.pageCount || "Unknown"}</div>
                <div class="field"><strong>Language:</strong> ${info.language || "Unknown"}</div>
                <div class="field"><strong>Description:</strong><br>${info.description || "No description available."}</div>
              </body>
              </html>
            `;
            const win = window.open("", "_blank");
            win.document.write(html);
            win.document.close();
          };
        })
        .catch(error => {
          console.error("Failed to load books:", error);
        });
    });
  </script>

  <footer>
    &copy; All entries recorded and held.
  </footer>
</body>

</html>
